% This code is an implementation of H.265/HEVC encoder based on "Algorithm and Architecture Design of the H.265/HEVC Intra Encoder" by "Grzegorz Pastuszak and Andrzej Abramowski"
% Author :      Marzieh Hosseinkhani
% Copyright :   (c) 2018, All Rights Reserved


function [ M_Matrice, Quant_Matrice ] = GetTables( TempSize )

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% HEVC Tables
%%%%%%%%%%% 4, 8, 16, 32 sizes

M_Mat = cell(4,1);
Quant_Mat = cell(4,1);

M4_Mat_DCT = [64, 64, 64, 64; 83, 36, -36, -83; 64, -64, -64, 64; 36, -83, 83, -36];

M4_Mat_DST = [29, 55, 74, 84; 74, 74, 0, -74; 84, -29, -74, 55; 55, -84, 74 -29];

M8_Mat = [64, 64, 64, 64, 64, 64, 64, 64;...
    89, 75, 50, 18, -18, -50, -75, -89;...
    83, 36, -36, -83, -83, -36, 36, 83;...
    75, -18, -89, -50, 50, 89, 18, -75;...
    64, -64, -64, 64, 64, -64, -64, 64;...
    50, -89, 18, 75, -75, -18, 89, -50;...
    36, -83, 83, -36, -36, 83, -83, 36;...
    18, -50, 75, -89, 89, -75, 50, -18];

M16_Mat = [64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64;...
     90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90;...
     89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89;...
     87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87;...
     83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83;...
     80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80;...
     75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75;...
     70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70;...
     64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64;...
     57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57;...
     50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50;...
     43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43;...
     36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36;...
     25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25;...
     18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18;...
     9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9];
 
 M32_Mat = [64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64;...
     90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4, -4, -13, -22, -31, -38, -46, -54, -61, -67, -73, -78, -82, -85, -88, -90, -90;...
     90, 87, 80, 70, 57, 43, 25, 9, -9, -25, -43, -57, -70, -80, -87, -90,-90, -87, -80, -70, -57, -43, -25, -9, 9, 25, 43, 57, 70, 80, 87, 90;...
     90, 82, 67, 46, 22, -4, -31, -54, -73, -85, -90, -88, -78, -61, -38, -13, 13, 38, 61, 78, 88, 90, 85, 73, 54, 31, 4,-22,-46,-67,-82,-90;...
     89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89, 89, 75, 50, 18, -18, -50, -75, -89, -89, -75, -50, -18, 18, 50, 75, 89;...
     88, 67, 31, -13, -54, -82, -90, -78, -46, -4, 38, 73, 90, 85, 61, 22, -22, -61, -85, -90, -73, -38, 4, 46, 78, 90, 82, 54, 13, -31, -67, -88;...
     87, 57, 9, -43, -80, -90, -70, -25, 25, 70, 90, 80, 43, -9, -57, -87, -87, -57, -9, 43, 80, 90, 70, 25, -25, -70, -90, -80, -43, 9, 57, 87;...
     85, 46,-13, -67, -90, -73, -22, 38, 82, 88, 54, -4, -61, -90, -78, -31, 31, 78, 90, 61, 4,-54, -88, -82, -38, 22, 73, 90, 67, 13, -46, -85;...
     83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83, 83, 36, -36, -83, -83, -36, 36, 83;...
     82, 22, -54, -90, -61, 13, 78, 85, 31, -46, -90, -67, 4, 73, 88, 38, -38, -88, -73, -4, 67, 90, 46, -31, -85, -78, -13, 61, 90, 54, -22,-82;...
     80, 9, -70, -87, -25, 57, 90, 43, -43, -90, -57, 25, 87, 70, -9, -80, -80, -9, 70, 87, 25, -57, -90, -43, 43, 90, 57,-25, -87, -70, 9, 80;...
     78, -4, -82, -73, 13, 85, 67, -22, -88, -61, 31, 90, 54, -38, -90, -46, 46, 90, 38, -54, -90, -31, 61, 88, 22, -67, -85, -13, 73, 82, 4, -78;...
     75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75, 75, -18, -89, -50, 50, 89, 18, -75, -75, 18, 89, 50, -50, -89, -18, 75;...
     73, -31, -90, -22, 78, 67, -38, -90, -13, 82, 61, -46, -88, -4, 85, 54, -54, -85, 4, 88, 46, -61, -82, 13, 90, 38, -67, -78, 22, 90, 31, -73;...
     70, -43, -87, 9, 90, 25, -80, -57, 57, 80, -25, -90, -9, 87, 43, -70, -70, 43, 87, -9, -90, -25, 80, 57, -57, -80, 25, 90, 9, -87, -43, 70;...
     67, -54, -78, 38, 85, -22, -90, 4, 90, 13, -88,  -31, 82, 46, -73, -61, 61, 73, -46, -82, 31, 88, -13, -90, -4, 90, 22, -85, -38, 78, 54, -67;...
     64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64, 64, -64, -64, 64;...
     61, -73, -46, 82, 31, -88, -13, 90, -4, -90, 22, 85, -38, -78, 54, 67, -67, -54, 78, 38, -85, -22, 90, 4, -90, 13, 88, -31, -82, 46, 73, -61;...
     57, -80, -25, 90, -9, -87, 43, 70, -70, -43, 87, 9, -90, 25, 80, -57, -57, 80, 25, -90, 9, 87, -43, -70, 70, 43, -87, -9, 90, -25, -80, 57;...
     54, -85, -4, 88, -46, -61, 82, 13, -90, 38, 67, -78, -22, 90, -31, -73, 73, 31, -90, 22, 78, -67, -38, 90, -13, -82, 61, 46, -88, 4, 85, -54;...
     50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50, 50, -89, 18, 75, -75, -18, 89, -50, -50, 89, -18, -75, 75, 18, -89, 50;...
     46, -90, 38, 54, -90, 31, 61, -88, 22, 67, -85, 13, 73, -82, 4, 78, -78, -4, 82, -73, -13, 85, -67, -22, 88, -61, -31, 90, -54, -38, 90, -46;...
     43, -90, 57, 25, -87, 70, 9, -80, 80, -9, -70, 87, -25, -57, 90, -43, -43, 90, -57, -25, 87, -70, -9, 80, -80, 9, 70, -87, 25, 57, -90, 43;...
     38, -88, 73, -4, -67, 90, -46, -31, 85, -78, 13, 61, -90, 54, 22, -82, 82, -22, -54, 90, -61, -13, 78, -85, 31, 46, -90, 67, 4, -73, 88, -38;...
     36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36, 36, -83, 83, -36, -36, 83, -83, 36;...
     31, -78, 90, -61, 4, 54, -88, 82, -38, -22, 73, -90, 67, -13, -46, 85, -85, 46, 13, -67, 90, -73, 22, 38, -82, 88, -54, -4, 61, -90, 78, -31;...
     25, -70, 90, -80, 43, 9, -57, 87, -87, 57, -9, -43, 80, -90, 70, -25, -25, 70, -90, 80, -43, -9, 57, -87, 87, -57, 9, 43, -80, 90, -70, 25;...
     22, -61, 85, -90, 73, -38, -4, 46, -78, 90, -82, 54, -13, -31, 67, -88, 88, -67, 31, 13, -54, 82, -90, 78, -46, 4, 38, -73, 90, -85, 61, -22;...
     18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18, 18, -50, 75, -89, 89, -75, 50, -18, -18, 50, -75, 89, -89, 75, -50, 18;...
     13, -38, 61, -78, 88, -90, 85, -73, 54, -31, 4, 22, -46, 67, -82, 90, -90, 82, -67, 46, -22, -4, 31, -54, 73, -85, 90, -88, 78, -61, 38, -13;...
     9, -25, 43, -57, 70, -80, 87, -90, 90, -87, 80, -70, 57, -43, 25, -9, -9, 25, -43, 57, -70, 80, -87, 90, -90, 87, -80, 70, -57, 43, -25, 9;...
     4, -13, 22, -31, 38, -46, 54, -61, 67, -73, 78, -82, 85, -88, 90, -90, 90, -90, 88, -85, 82, -78, 73, -67, 61, -54, 46, -38, 31, -22, 13, -4];
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% HEVC Quantization Tables
%%%%%%%%%%% 4, 8, 16, 32 sizes

 Quant4_Mat = [16, 16, 16, 16; 16, 16, 16, 16; 16, 16, 16, 16; 16, 16, 16, 16];

 Quant8_Mat = [16, 16, 16, 16, 17, 18, 21, 24;...       % for intra
              16, 16, 16, 16, 17, 19, 22, 25;...
              16, 16, 17, 18, 20, 22, 25, 29;...
              16, 16, 18, 21, 24, 27, 31, 36;...
              17, 17, 20, 24, 30, 35, 41, 47;...
              18, 19, 22, 27, 35, 44, 54, 65;...
              21, 22, 25, 31, 41, 54, 70, 88;...
              24, 25, 29, 36, 47, 65, 88, 115];
          
%    Fixed value in 9903
  Quant16_Mat = [16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17, 17, 18 ,18 ,21 ,21 ,24 ,24;...     
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,18, 18 ,21 ,21 ,24 ,24;...     
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,19, 19 ,22 ,22 ,25 ,25;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,19, 19 ,22 ,22 ,25 ,25;...
                 16 ,16 ,16 ,16 ,17 ,17 ,18 ,18 ,20 ,20 ,22, 22 ,25 ,25 ,29 ,29;...
                 16 ,16 ,16 ,16 ,17 ,17 ,18 ,18 ,20 ,20 ,22, 22 ,25 ,25 ,29 ,29;...
                 16 ,16 ,16 ,16 ,18 ,18 ,21 ,21 ,24 ,24 ,27 ,27 ,31 ,31 ,36 ,36;...
                 16 ,16 ,16 ,16 ,18 ,18 ,21 ,21 ,24 ,24 ,27 ,27 ,31 ,31 ,36 ,36;...
                 17 ,17 ,17 ,17 ,20 ,20 ,24 ,24 ,30 ,30 ,35 ,35 ,41 ,41 ,47 ,47;...
                 17 ,17 ,17 ,17 ,20 ,20 ,24 ,24 ,30 ,30 ,35 ,35 ,41 ,41 ,47 ,47;...
                 18 ,18 ,19 ,19 ,22 ,22 ,27 ,27 ,35 ,35 ,44 ,44 ,54 ,54 ,65 ,65;...
                 18 ,18 ,19 ,19 ,22 ,22 ,27 ,27 ,35 ,35 ,44 ,44 ,54 ,54 ,65 ,65;...
                 21 ,21 ,22 ,22 ,25 ,25 ,31 ,31 ,41 ,41 ,54 ,54 ,70 ,70 ,88 ,88;...
                 21 ,21 ,22 ,22 ,25 ,25 ,31 ,31 ,41 ,41 ,54 ,54 ,70 ,70 ,88 ,88;...
                 24 ,24 ,25 ,25 ,29 ,29 ,36 ,36 ,47 ,47 ,65 ,65 ,88 ,88 ,115 ,115;...
                 24 ,24 ,25 ,25 ,29 ,29 ,36 ,36 ,47 ,47 ,65 ,65 ,88 ,88 ,115 ,115];
                
 
 Quant32_Mat = [ 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24;...     
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18, 18 ,18, 18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24;...     
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24;...     
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18, 18 ,18, 18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,19, 19 ,19, 19 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,19, 19 ,19, 19 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,19, 19 ,19, 19 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,19, 19 ,19, 19 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,20 ,20 ,20 ,20 ,22, 22 ,22, 22 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,20 ,20 ,20 ,20 ,22, 22 ,22, 22 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,20 ,20 ,20 ,20 ,22, 22 ,22, 22 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,17 ,17 ,17 ,17 ,18 ,18 ,18 ,18 ,20 ,20 ,20 ,20 ,22, 22 ,22, 22 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24 ,27 ,27 ,27 ,27 ,31 ,31 ,31 ,31 ,36 ,36 ,36 ,36;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24 ,27 ,27 ,27 ,27 ,31 ,31 ,31 ,31 ,36 ,36 ,36 ,36;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24 ,27 ,27 ,27 ,27 ,31 ,31 ,31 ,31 ,36 ,36 ,36 ,36;...
                 16 ,16 ,16 ,16 ,16 ,16 ,16 ,16 ,18 ,18 ,18 ,18 ,21 ,21 ,21 ,21 ,24 ,24 ,24 ,24 ,27 ,27 ,27 ,27 ,31 ,31 ,31 ,31 ,36 ,36 ,36 ,36;...
                 17 ,17 ,17 ,17 ,17 ,17 ,17 ,17,20 ,20 ,20 ,20 ,24 ,24 ,24 ,24 ,30 ,30 ,30 ,30 ,35 ,35 ,35 ,35 ,41 ,41 ,41 ,41 ,47 ,47 ,47 ,47;...
                 17 ,17 ,17 ,17 ,17 ,17 ,17 ,17,20 ,20 ,20 ,20 ,24 ,24 ,24 ,24 ,30 ,30 ,30 ,30 ,35 ,35 ,35 ,35 ,41 ,41 ,41 ,41 ,47 ,47 ,47 ,47;...
                 17 ,17 ,17 ,17 ,17 ,17 ,17 ,17,20 ,20 ,20 ,20 ,24 ,24 ,24 ,24 ,30 ,30 ,30 ,30 ,35 ,35 ,35 ,35 ,41 ,41 ,41 ,41 ,47 ,47 ,47 ,47;...
                 17 ,17 ,17 ,17 ,17 ,17 ,17 ,17,20 ,20 ,20 ,20 ,24 ,24 ,24 ,24 ,30 ,30 ,30 ,30 ,35 ,35 ,35 ,35 ,41 ,41 ,41 ,41 ,47 ,47 ,47 ,47;...
                 18 ,18 ,18 ,18 ,19 ,19 ,19 ,19 ,22 ,22 ,22 ,22 ,27 ,27 ,27 ,27 ,35 ,35 ,35 ,35 ,44 ,44 ,44 ,44 ,54 ,54 ,54 ,54 ,65 ,65 ,65 ,65;...
                 18 ,18 ,18 ,18 ,19 ,19 ,19 ,19 ,22 ,22 ,22 ,22 ,27 ,27 ,27 ,27 ,35 ,35 ,35 ,35 ,44 ,44 ,44 ,44 ,54 ,54 ,54 ,54 ,65 ,65 ,65 ,65;...
                 18 ,18 ,18 ,18 ,19 ,19 ,19 ,19 ,22 ,22 ,22 ,22 ,27 ,27 ,27 ,27 ,35 ,35 ,35 ,35 ,44 ,44 ,44 ,44 ,54 ,54 ,54 ,54 ,65 ,65 ,65 ,65;...
                 18 ,18 ,18 ,18 ,19 ,19 ,19 ,19 ,22 ,22 ,22 ,22 ,27 ,27 ,27 ,27 ,35 ,35 ,35 ,35 ,44 ,44 ,44 ,44 ,54 ,54 ,54 ,54 ,65 ,65 ,65 ,65;...
                 21 ,21 ,21 ,21 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25 ,31 ,31 ,31 ,31 ,41 ,41 ,41 ,41 ,54 ,54 ,54 ,54 ,70 ,70 ,70 ,70 ,88 ,88 ,88 ,88;...
                 21 ,21 ,21 ,21 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25 ,31 ,31 ,31 ,31 ,41 ,41 ,41 ,41 ,54 ,54 ,54 ,54 ,70 ,70 ,70 ,70 ,88 ,88 ,88 ,88;...
                 21 ,21 ,21 ,21 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25 ,31 ,31 ,31 ,31 ,41 ,41 ,41 ,41 ,54 ,54 ,54 ,54 ,70 ,70 ,70 ,70 ,88 ,88 ,88 ,88;...
                 21 ,21 ,21 ,21 ,22 ,22 ,22 ,22 ,25 ,25 ,25 ,25 ,31 ,31 ,31 ,31 ,41 ,41 ,41 ,41 ,54 ,54 ,54 ,54 ,70 ,70 ,70 ,70 ,88 ,88 ,88 ,88;...
                 24 ,24 ,24 ,24 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29 ,36 ,36 ,36 ,36 ,47 ,47 ,47 ,47 ,65 ,65 ,65 ,65 ,88 ,88 ,88 ,88 ,115 ,115 ,115 ,115;...
                 24 ,24 ,24 ,24 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29 ,36 ,36 ,36 ,36 ,47 ,47 ,47 ,47 ,65 ,65 ,65 ,65 ,88 ,88 ,88 ,88 ,115 ,115 ,115 ,115;...
                 24 ,24 ,24 ,24 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29 ,36 ,36 ,36 ,36 ,47 ,47 ,47 ,47 ,65 ,65 ,65 ,65 ,88 ,88 ,88 ,88 ,115 ,115 ,115 ,115;...
                 24 ,24 ,24 ,24 ,25 ,25 ,25 ,25 ,29 ,29 ,29 ,29 ,36 ,36 ,36 ,36 ,47 ,47 ,47 ,47 ,65 ,65 ,65 ,65 ,88 ,88 ,88 ,88 ,115 ,115 ,115 ,115];
           
%     Image16_Mat = [106, 101, 95, 90, 86, 80, 75, 70, 106, 101, 95, 90, 86, 80, 75, 70;...
%                  105, 99, 93, 88, 84, 78, 73, 67, 105, 99, 93, 88, 84, 78, 73, 67;...
%                  103, 97, 91, 86, 82, 75, 70, 64, 103, 97, 91, 86, 82, 75, 70, 64;...
%                  100, 94, 88, 83, 79, 72, 65, 60, 100, 94, 88, 83, 79, 72, 65, 60;...
%                  99, 92, 86, 82, 76, 68, 61, 57, 99, 92, 86, 82, 76, 68, 61, 57;...
%                  97, 91, 85, 79, 73, 65, 58, 54, 97, 91, 85, 79, 73, 65, 58, 54;...
%                  95, 89, 82, 76, 70, 61, 55, 51, 95, 89, 82, 76, 70, 61, 55, 51;...
%                  94, 88, 82, 74, 66, 59, 53, 49, 94, 88, 82, 74, 66, 59, 53, 49;...
%                  106, 101, 95, 90, 86, 80, 75, 70, 106, 101, 95, 90, 86, 80, 75, 70;...
%                  105, 99, 93, 88, 84, 78, 73, 67, 105, 99, 93, 88, 84, 78, 73, 67;...
%                  103, 97, 91, 86, 82, 75, 70, 64, 103, 97, 91, 86, 82, 75, 70, 64;...
%                  100, 94, 88, 83, 79, 72, 65, 60, 100, 94, 88, 83, 79, 72, 65, 60;...
%                  99, 92, 86, 82, 76, 68, 61, 57, 99, 92, 86, 82, 76, 68, 61, 57;...
%                  97, 91, 85, 79, 73, 65, 58, 54, 97, 91, 85, 79, 73, 65, 58, 54;...
%                  95, 89, 82, 76, 70, 61, 55, 51, 95, 89, 82, 76, 70, 61, 55, 51;...
%                  94, 88, 82, 74, 66, 59, 53, 49, 94, 88, 82, 74, 66, 59, 53, 49];
                    

M_Mat{1} = M4_Mat_DST;
M_Mat{2} = M8_Mat;
M_Mat{3} = M16_Mat;
M_Mat{4} = M32_Mat;
             
Quant_Mat{1} = Quant4_Mat;
Quant_Mat{2} = Quant8_Mat;
Quant_Mat{3} = Quant16_Mat;
Quant_Mat{4} = Quant32_Mat;

        if(TempSize== 4)
            M_Mat_idx = 1;
            Quant_Mat_idx = 1;
        elseif(TempSize== 8)
            M_Mat_idx = 2;
            Quant_Mat_idx = 2;
        elseif(TempSize== 16)
            M_Mat_idx = 3;
            Quant_Mat_idx = 3;
        elseif(TempSize== 32)
            M_Mat_idx = 4;
            Quant_Mat_idx = 4;
        else
            disp('Unsupported matrix Size');
        end
        
      M_Matrice = M_Mat{M_Mat_idx};
      Quant_Matrice = Quant_Mat{Quant_Mat_idx};
end



%% previous
%  Quant16_Mat = [16 ,16 ,16 ,16 ,16 ,16 ,16, 16, 17, 17, 18, 19, 21, 22, 24, 27;...     %FIX ME incorrect
%                  16,16,16,16,16,16,16,16,17,18,18,20,21,23,25,27;...
%                  16,16,16,16,16,16,16,17,17,18,19,20,22,23,25,28;...
%                  16,16,16,16,16,16,17,17,18,19,20,21,23,25,27,29;...
%                  16,16,16,16,17,17,18,19,20,21,22,23,25,27,29,31;...
%                  16,16,16,16,17,18,19,20,22,23,24,26,27,29,32,34;...
%                  16,16,16,17,18,19,21,23,24,25,27,29,31,33,36,39;...
%                  16,16,17,17,19,20,23,25,27,29,31,33,35,38,41,44;...
%                  17,17,17,18,20,22,24,27,30,32,35,38,41,44,47,51;...
%                  17,18,18,19,21,23,25,29,32,36,40,43,47,51,55,60;...
%                  18,18,19,20,22,24,27,31,35,40,44,49,54,59,65,70;...
%                  19,20,20,21,23,26,29,33,38,43,49,56,62,69,75,82;...
%                  21,21,22,23,25,27,31,35,41,47,54,62,70,79,88,97;...
%                  22,23,23,25,27,29,33,38,44,51,59,69,79,90,101,113;...
%                  24,25,25,27,29,32,36,41,47,55,65,75,88,101,115,130;...
%                  27,27,28,29,31,34,39,44,51,60,70,82,97,113,130,149];
%  
%  Quant32_Mat = [ 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24;...
%                  16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25;...
%                  16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29;...
%                  16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36;...
%                  17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47;...
%                  18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65;...
%                  21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88;...
%                  24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115;...
%                  16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24;...
%                  16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25;...
%                  16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29;...
%                  16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36;...
%                  17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47;...
%                  18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65;...
%                  21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88;...
%                  24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115;...
%                  16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24;...
%                  16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25;...
%                  16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29;...
%                  16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36;...
%                  17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47;...
%                  18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65;...
%                  21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88;...
%                  24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115;...
%                  16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24, 16, 16, 16, 16, 17, 18, 21, 24;...
%                  16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25, 16, 16, 16, 16, 17, 19, 22, 25;...
%                  16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29, 16, 16, 17, 18, 20, 22, 25, 29;...
%                  16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36, 16, 16, 18, 21, 24, 27, 31, 36;...
%                  17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47, 17, 17, 20, 24, 30, 35, 41, 47;...
%                  18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65, 18, 19, 22, 27, 35, 44, 54, 65;...
%                  21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88, 21, 22, 25, 31, 41, 54, 70, 88;...
%                  24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115, 24, 25, 29, 36, 47, 65, 88, 115];
%            
